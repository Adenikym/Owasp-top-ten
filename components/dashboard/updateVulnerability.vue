<template>
<v-overlay :value="open" >
  <div class="t-bg-white t-w-[500px] t-px-10 t-py-10 t-rounded-container-lg t-h-screen t-overflow-y-scroll">
<div class="t-flex t-justify-between t-items-center ">
          <span class=" t-text-primary t-font-bold t-text-2xl ">Update Vulnerability</span>
          <v-btn light icon>
            <v-icon @click="closeForm" color="#000">mdi-close</v-icon>
          </v-btn>
        </div>

        <div class="mt-6">
<v-form  ref="form" v-model="valid" lazy-validation >
  <v-text-field
    v-model="vulnerability.name"
    :rules="nameRules"
    label="Name"
    required
    light
  ></v-text-field>
  <v-textarea
    v-model="vulnerability.description"
    label="Description"
    :rules="descriptionRules"
    required
    light
  ></v-textarea>
  <v-text-field
    v-model="vulnerability.occurences"
    label="Number of Occurences"
    :rules="occurenceRules"
    type="number"
    required
    light
  ></v-text-field>
  <v-text-field
    v-model="vulnerability.maxCoverage"
    label="Max coverage"
    :rules="coverageRules"
    type="number"
    required
    light
  ></v-text-field>
 
  
  
  <v-btn @click="updateVunerability"  color="#AFE614" flat light>
    <span class="t-capitalize t-text-white">Update</span>

  </v-btn>
 
</v-form>
        </div>
  </div>
</v-overlay>

</template>

<script>
 import vulnerabilities from "../../vulnurabilities";
export default {
props:['open','vulnerability'],
data(){
    return{
     form:{
         name:this.vulnerability.name,
         description:this.vulnerability.description,
         occurences:this.vulnerability.occurences,
         maxCoverage:this.vulnerability.maxCoverage,
         id:this.vulnerability.id
     },
     vulnerabilities:vulnerabilities,
     valid:true,
       nameRules:[
         v => !!v || 'Name is required',
         v => (v && v.length <= 50) || 'Name must be less than 50 characters'
     ],
      descriptionRules:[
          v => !!v || 'Description is required'
      ],
      occurenceRules:[
          v => !!v || 'Occurence is required'
      ],
      coverageRules:[
          v => !!v || 'Max coverage is required',
          v => (v <= 100) || 'Max coverage must be less than or equal to 100'
      ],
      
    }
},
methods:{
  closeForm(){
    this.$emit('close-update-vulnerability-form')
  },

  updateVunerability(){
    if(this.$refs.form.validate()){
       this.$emit('update-vulnerability',this.vulnerability)
     this.$emit('close-update-vulnerability-form')
    }
    
  }
}
}
</script>

<style scoped>
*{
  font-family: 'Sora', sans-serif;
}
</style>